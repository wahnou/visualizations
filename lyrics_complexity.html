<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.0/d3.min.js" integrity="sha512-jXsLjbg/Pr8F5U2evjFaEci7mImlUix865lbvnNmp5TzS86+VTTFVDz7FFTS6VHdhSn7UJ4tjZdvpp0GgT0fZA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <title>Swarm Plot</title>
    <link rel="stylesheet" href="global.css">
</head>

<body>
    <svg id="viz" class="viz"></svg>
</body>

</html>
<script>
    const width = 1000;
    const height = 250;
    
    const margin = [50, 60, 50, 100];
    let svg = d3.select("#viz")
        .attr("height", height)
        .attr("width", width)
        .attr("viewBox", "0 0 "+width+" "+height);

    const artists = [
        {
            "name": "Brad Paisley",
            "avg": 38
        },{
            "name": "Eminem",
            "avg": 40
        },{
            "name": "George Strait",
            "avg": 40
        },{
            "name": "Lil wayne",
            "avg": 40
        },{
            "name": "Tim McGraw",
            "avg": 41
        },{
            "name": "Trace Adkin",
            "avg": 42
        },{
            "name": "Jay-Z",
            "avg": 43
        },{
            "name": "Lonestar",
            "avg": 44
        },{
            "name": "Kenny chesney",
            "avg": 44
        },{
            "name": "Montgomery Gentry",
            "avg": 45
        },{
            "name": "Toby Keiht",
            "avg": 45
        }
    ]

    let complexity = Array.from(new Set(artists.map((d) => d.avg)));
    let xScale = d3
        .scaleBand()
        .domain(complexity)
        .range([margin[3], width - margin[1]]);
    
        let yScale = d3
        .scaleLinear()
        .domain(d3.extent(artists.map((d) => +0)))
        .range([height - margin[2], margin[0]]);
        
    let color = d3.scaleOrdinal().domain(complexity).range(d3.schemePaired);

    let marketcapDomain = d3.extent(artists.map((d) => +0));
    let size = d3.scaleSqrt().domain(marketcapDomain).range([3, 40]);

    svg.selectAll(".circ")
    .data(artists)
    .enter()
    .append("circle")
    .attr("class", "circ")
    .attr("stroke", "black")
    .attr("fill", (d) => color(d.avg))
    .attr("r", (d) => size(1))
    .attr("cx", (d) => xScale(d.avg))
    .attr("cy", (d) => yScale(0));

        
    // Force simulation
    let simulation = d3.forceSimulation(artists)
    
    .force("x", d3.forceX((d) => {
        return xScale(d.avg);
        }).strength(0.2))
    
    .force("y", d3.forceY((d) => {
        return yScale(0);
        }).strength(1))
    
    .force("collide", d3.forceCollide((d) => {
        return size(0);
        }))
        
    .alphaDecay(0)
    .alpha(0.3)
    .on("tick", tick);
    
    function tick() {
        d3.selectAll(".circ")
        .attr("cx", (d) => d.x)
        .attr("cy", (d) => d.y);
    }

    let init_decay = setTimeout(function () {
        simulation.alphaDecay(0.1);
    }, 3000); // start decay after 3 seconds
</script>
<script src="script.js"></script>